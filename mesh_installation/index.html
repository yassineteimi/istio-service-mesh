
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Istio service mesh implementation guide, based on my own experience.">
      
      
        <meta name="author" content="Yassine TEIMI">
      
      
      
        <link rel="prev" href="../design_considerations/">
      
      
        <link rel="next" href="../traffic_management/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>Mesh installation - Istio Service Mesh Asset</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#istio-service-mesh-installation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Istio Service Mesh Asset" class="md-header__button md-logo" aria-label="Istio Service Mesh Asset" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Istio Service Mesh Asset
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mesh installation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/yassineteimi/istio-service-mesh" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    yassineteimi/istio-service-mesh
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
  Introduction to Istio service mesh

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  Istio Mesh Design

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../mesh_edge_security/" class="md-tabs__link">
          
  
  Istio Mesh Security

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../mesh_observability/" class="md-tabs__link">
          
  
  Istio Mesh Management

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Istio Service Mesh Asset" class="md-nav__button md-logo" aria-label="Istio Service Mesh Asset" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Istio Service Mesh Asset
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/yassineteimi/istio-service-mesh" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    yassineteimi/istio-service-mesh
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction to Istio service mesh
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Introduction to Istio service mesh
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../istio_architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Istio Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../why_istio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Why istio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../before_istio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Things to know before implementing Istio service mesh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design_considerations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Design considerations at the edge of the servicemesh
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Istio Mesh Design
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Istio Mesh Design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Mesh installation
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Mesh installation
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-redhat-istio-service-mesh-operator-on-openshift" class="md-nav__link">
    <span class="md-ellipsis">
      Using RedHat Istio service mesh operator on Openshift
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using RedHat Istio service mesh operator on Openshift">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Installing operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-workloads-into-the-mesh" class="md-nav__link">
    <span class="md-ellipsis">
      Adding workloads into the mesh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enabling-sidecar-autoinjection" class="md-nav__link">
    <span class="md-ellipsis">
      Enabling sideCar autoInjection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-istio-upstream-k8s" class="md-nav__link">
    <span class="md-ellipsis">
      Using Istio upstream (K8s)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using Istio upstream (K8s)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-istio-using-istioctl" class="md-nav__link">
    <span class="md-ellipsis">
      Install Istio using istioctl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-istio-to-k8s-cluster-using-istio-config-profile" class="md-nav__link">
    <span class="md-ellipsis">
      Install Istio to K8s cluster using istio config profile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enable-istio-sidecar-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Enable Istio Sidecar Injection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../traffic_management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Traffic management
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Istio Mesh Security
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Istio Mesh Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mesh_edge_security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TLS/HTTPS at the edge of the mesh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../oauth_jwt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OAuth at the edge of the mesh
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Istio Mesh Management
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Istio Mesh Management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mesh_observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mesh Observability and monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mesh_debug/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debug your mesh
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="istio-service-mesh-installation">Istio service mesh installation</h1>
<h2 id="using-redhat-istio-service-mesh-operator-on-openshift">Using RedHat Istio service mesh operator on Openshift</h2>
<h3 id="installing-operators">Installing operators</h3>
<p>You must install all operators from redhat, otherwise, there is no redhat support, and it will install an old Istio version without you KNOWING IT (for me it was v1.4.11), and the latest version is at the time writing this : 1.12.</p>
<p>Install the following operators in this in order:</p>
<ol>
<li>ElasticSearch (from Redhat)
   Update channel: stable.
   Installation mode: default.
   (namespace: openshift-operators-redhat).
   Update approval: automatic.</li>
<li>Jaeger - Red Hat OpenShift distributed tracing platform (from redhat)
   Installation mode: default.
   (namespace: openshift-distributed-tracing).
   Update approval: automatic.</li>
<li>Kiali (from redhat).
   Update channel: stable.
   Installation mode: default.
   (namespace: openshift-operators).
   Update approval: automatic.</li>
<li>Redhat service mesh operator. (redhat)
   Update channel: stable.
   Installation mode: default.
   (namespace: openshift-operators).
   Update approval: automatic.</li>
</ol>
<p>You can choose between automatic and manual update approval. (automatic for demo purposes)</p>
<p>Variable setting:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># namespace to add into the service mesh</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">OCP_NS</span><span class="o">=</span>myservicemesh-namespace
</code></pre></div></p>
<p>Check that the operators involved in the Service Mesh installation are installed properly:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>$<span class="w"> </span>oc<span class="w"> </span>get<span class="w"> </span>subscription<span class="w"> </span>-n<span class="w"> </span>openshift-operators
</code></pre></div>
<p>Check the installation with the ClusterServiceVersion custom resource:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>$<span class="w"> </span>oc<span class="w"> </span>get<span class="w"> </span>ClusterServiceVersion
</code></pre></div>
<p>Create a namespace called istio-system where the Service Mesh control plane will be installed:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">cd</span><span class="w"> </span>Istio
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>cat<span class="w"> </span>servicemesh-namespace.yml
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>$<span class="w"> </span>oc<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>servicemesh-namespace.yml
</code></pre></div>
<p>Create a service mesh controle plane and service member roll in the istio-system namespace and add your namespace into the istio control plane:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>cat<span class="w"> </span>istio/basic-istio-install.yml<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nv">NAMESPACE</span><span class="o">=</span><span class="nv">$OCP_NS</span><span class="w"> </span>envsubst<span class="w"> </span><span class="p">|</span><span class="w"> </span>oc<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
</code></pre></div>
<p>Run the following command to verify the ServiceMeshContolPlane &amp; ServiceMeshMemberRoll was created successfully:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>oc<span class="w"> </span>get<span class="w"> </span>smmr<span class="w"> </span>-n<span class="w"> </span>istio-system<span class="w"> </span>default
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>watch<span class="w"> </span>-n<span class="w"> </span><span class="m">0</span>.2<span class="w"> </span>oc<span class="w"> </span>get<span class="w"> </span>smcp<span class="w"> </span>-n<span class="w"> </span>istio-system<span class="w"> </span>basic
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c1">#it will take few minutes</span>
</code></pre></div>
<h3 id="adding-workloads-into-the-mesh">Adding workloads into the mesh</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>$<span class="w"> </span>oc<span class="w"> </span>edit<span class="w"> </span>smmr<span class="w"> </span>-n<span class="w"> </span>&lt;controlplane-namespace&gt;
</code></pre></div>
<p>Modify the SMMR YAML to add or remove projects as members.
You can add any number of projects, but a project can only belong to one ServiceMeshMemberRoll resource.</p>
<h3 id="enabling-sidecar-autoinjection">Enabling sideCar autoInjection</h3>
<p>SideCar autoInjection can be enabled using annotation at the your application deployment level:</p>
<p>First of all, let's check our deployment annotations:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>$<span class="w"> </span>oc<span class="w"> </span>get<span class="w"> </span>deployment<span class="w"> </span>-n<span class="w"> </span>my-deployment<span class="w"> </span>-o<span class="w"> </span>yaml
</code></pre></div>
<p>You must add the following annotation <code>sidecar.istio.io/inject: 'true'</code> fllowing this path: <code>spec &gt; template &gt; metadata &gt; annotations</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># example:</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>annotations:<span class="w"> </span>sidecar.istio.io/inject:<span class="w"> </span><span class="s1">&#39;true&#39;</span>
</code></pre></div>
<p>You can do it at the statefulset level also, it's not recommended at the pod level (because of versatility).</p>
<h2 id="using-istio-upstream-k8s">Using Istio upstream (K8s)</h2>
<h3 id="install-istio-using-istioctl">Install Istio using istioctl</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># first install istioctl CLI</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>curl<span class="w"> </span>-L<span class="w"> </span>https://istio.io/downloadIstio<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nv">ISTIO_VERSION</span><span class="o">=</span><span class="m">1</span>.6.6<span class="w"> </span>sh<span class="w"> </span>-
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="nb">cd</span><span class="w"> </span>istio-1.6.6
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export PATH=</span><span class="nv">$PWD</span><span class="s2">/bin:</span><span class="nv">$PATH</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bash_profile
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="c1"># open new shell to load updated PATH variable</span>
</code></pre></div>
<h3 id="install-istio-to-k8s-cluster-using-istio-config-profile">Install Istio to K8s cluster using istio config profile</h3>
<p>Ref: https://istio.io/latest/docs/setup/additional-setup/config-profiles/</p>
<p>There are a few preset profiles we can install:</p>
<ul>
<li>default</li>
<li>demo</li>
<li>minimal</li>
<li>etc</li>
</ul>
<p><img alt="alt text" src="../imgs/istio_profile.png" title="Istio" /></p>
<p>I recommend to install <code>demo</code> profile, which comes with ingress/egress gateways, as well as grafana, kiali, jaegger (request tracing), and prometheus monitoring/metrics dashboards.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># display the list of available profiles</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>istioctl<span class="w"> </span>profile<span class="w"> </span>list
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="c1"># save config into yaml</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>istioctl<span class="w"> </span>profile<span class="w"> </span>dump<span class="w"> </span>demo<span class="w"> </span>&gt;<span class="w"> </span>profile_demo_config.yaml
</code></pre></div>
<p>Output
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>apiVersion:<span class="w"> </span>install.istio.io/v1alpha1
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>kind:<span class="w"> </span>IstioOperator
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>spec:
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">  </span>addonComponents:
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span>grafana:
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">      </span>enabled:<span class="w"> </span><span class="nb">true</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">      </span>k8s:
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">        </span>replicaCount:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">    </span>istiocoredns:
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">      </span>enabled:<span class="w"> </span><span class="nb">false</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">    </span>kiali:
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">      </span>enabled:<span class="w"> </span><span class="nb">true</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">      </span>k8s:
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">        </span>replicaCount:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="w">    </span>prometheus:
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="w">      </span>enabled:<span class="w"> </span><span class="nb">true</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="w">      </span>k8s:
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">        </span>replicaCount:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="w">    </span>tracing:
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="w">      </span>enabled:<span class="w"> </span><span class="nb">true</span>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">  </span>components:
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">    </span>base:
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="w">      </span>enabled:<span class="w"> </span><span class="nb">true</span>
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="w">    </span>citadel:
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a><span class="w">      </span>enabled:<span class="w"> </span><span class="nb">false</span>
<a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a><span class="w">      </span>k8s:
<a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a><span class="w">        </span>strategy:
<a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a><span class="w">          </span>rollingUpdate:
<a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a><span class="w">            </span>maxSurge:<span class="w"> </span><span class="m">100</span>%
<a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a><span class="w">            </span>maxUnavailable:<span class="w"> </span><span class="m">25</span>%
<a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a><span class="w">    </span>cni:
<a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a><span class="w">      </span>enabled:<span class="w"> </span><span class="nb">false</span>
<a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a><span class="w">    </span>egressGateways:
<a id="__codelineno-11-34" name="__codelineno-11-34" href="#__codelineno-11-34"></a><span class="w">    </span>-<span class="w"> </span>enabled:<span class="w"> </span><span class="nb">true</span>
<a id="__codelineno-11-35" name="__codelineno-11-35" href="#__codelineno-11-35"></a><span class="w">      </span>k8s:
<a id="__codelineno-11-36" name="__codelineno-11-36" href="#__codelineno-11-36"></a><span class="w">        </span>resources:
<a id="__codelineno-11-37" name="__codelineno-11-37" href="#__codelineno-11-37"></a><span class="w">          </span>requests:
<a id="__codelineno-11-38" name="__codelineno-11-38" href="#__codelineno-11-38"></a><span class="w">            </span>cpu:<span class="w"> </span>10m
<a id="__codelineno-11-39" name="__codelineno-11-39" href="#__codelineno-11-39"></a><span class="w">            </span>memory:<span class="w"> </span>40Mi
<a id="__codelineno-11-40" name="__codelineno-11-40" href="#__codelineno-11-40"></a><span class="w">      </span>name:<span class="w"> </span>istio-egressgateway
</code></pre></div></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># generate a k8s manifest for profile &quot;demo&quot; before installation</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>istioctl<span class="w"> </span>manifest<span class="w"> </span>generate<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">  </span>--set<span class="w"> </span><span class="nv">profile</span><span class="o">=</span>demo<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">  </span>--set<span class="w"> </span>values.gateways.istio-ingressgateway.sds.enabled<span class="o">=</span><span class="nb">true</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">  </span>&gt;<span class="w"> </span>generated-manifest-demo.yaml
</code></pre></div>
<p>Install/update istio (won't work on v1.6)</p>
<p>~~kubectl apply -f generated-manifest-demo.yaml~~
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># note: &quot;istioctl manifest apply&quot; works for both v1.5 and v1.6, but will be deprecated from v1.7 in favor of istioctl install</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>&lt;!--<span class="w"> </span>istioctl<span class="w"> </span>manifest<span class="w"> </span>apply<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">  </span>--set<span class="w"> </span><span class="nv">profile</span><span class="o">=</span>demo<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">  </span>--set<span class="w"> </span>values.gateways.istio-ingressgateway.sds.enabled<span class="o">=</span><span class="nb">true</span><span class="w">  </span>--&gt;
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="c1"># use &quot;istioctl install&quot; instead</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>istioctl<span class="w"> </span>install<span class="w"> </span>--set<span class="w"> </span><span class="nv">profile</span><span class="o">=</span>demo
</code></pre></div></p>
<p>Output</p>
<details><summary>show</summary><p>

<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>✔<span class="w"> </span>Istio<span class="w"> </span>core<span class="w"> </span>installed<span class="w">                                                                          </span>✔<span class="w"> </span>Istiod<span class="w"> </span>installed<span class="w">  </span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>✔<span class="w"> </span>Ingress<span class="w"> </span>gateways<span class="w"> </span>installed
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>✔<span class="w"> </span>Egress<span class="w"> </span>gateways<span class="w"> </span>installed<span class="w">                                                                     </span>✔<span class="w"> </span>Addons<span class="w"> </span>installed<span class="w">                                                                              </span>✔<span class="w"> </span>Installation<span class="w"> </span><span class="nb">complete</span>
</code></pre></div>
</p></details>

<p>Analyze and detect potential issues with your Istio configuration
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>istioctl<span class="w"> </span>analyze<span class="w"> </span>--all-namespaces
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="c1"># output</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>Warn<span class="w"> </span><span class="o">[</span>IST0102<span class="o">]</span><span class="w"> </span><span class="o">(</span>Namespace<span class="w"> </span>default<span class="o">)</span><span class="w"> </span>The<span class="w"> </span>namespace<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>enabled<span class="w"> </span><span class="k">for</span><span class="w"> </span>Istio<span class="w"> </span>injection.<span class="w"> </span>Run<span class="w"> </span><span class="s1">&#39;kubectl label namespace default istio-injection=enabled&#39;</span><span class="w"> </span>to<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>it,<span class="w"> </span>or<span class="w"> </span><span class="s1">&#39;kubectl label namespace default istio-injection=disabled&#39;</span><span class="w"> </span>to<span class="w"> </span>explicitly<span class="w"> </span>mark<span class="w"> </span>it<span class="w"> </span>as<span class="w"> </span>not<span class="w"> </span>needing<span class="w"> </span>injection
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>Warn<span class="w"> </span><span class="o">[</span>IST0102<span class="o">]</span><span class="w"> </span><span class="o">(</span>Namespace<span class="w"> </span>kube-node-lease<span class="o">)</span><span class="w"> </span>The<span class="w"> </span>namespace<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>enabled<span class="w"> </span><span class="k">for</span><span class="w"> </span>Istio<span class="w"> </span>injection.<span class="w"> </span>Run<span class="w"> </span><span class="s1">&#39;kubectl label namespace kube-node-lease istio-injection=enabled&#39;</span><span class="w"> </span>to<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>it,<span class="w"> </span>or<span class="w"> </span><span class="s1">&#39;kubectl label namespace kube-node-lease istio-injection=disabled&#39;</span><span class="w"> </span>to<span class="w"> </span>explicitly<span class="w"> </span>mark<span class="w"> </span>it<span class="w"> </span>as<span class="w"> </span>not<span class="w"> </span>needing<span class="w"> </span>injection
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>Error:<span class="w"> </span>Analyzers<span class="w"> </span>found<span class="w"> </span>issues<span class="w"> </span>when<span class="w"> </span>analyzing<span class="w"> </span>all<span class="w"> </span>namespaces.
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>See<span class="w"> </span>https://istio.io/docs/reference/config/analysis<span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>causes<span class="w"> </span>and<span class="w"> </span>resolutions.
</code></pre></div></p>
<p>Show objects created
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pod,svc<span class="w"> </span>-n<span class="w"> </span>istio-system
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="c1"># output</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>NAME<span class="w">                                        </span>READY<span class="w">   </span>STATUS<span class="w">    </span>RESTARTS<span class="w">   </span>AGE
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>pod/grafana-5cc7f86765-krwvf<span class="w">                </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>5m51s
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>pod/istio-egressgateway-5c8f9897f7-sfqg6<span class="w">    </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>29m
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>pod/istio-ingressgateway-65dd885d75-bbqtn<span class="w">   </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>29m
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>pod/istio-tracing-8584b4d7f9-whwjr<span class="w">          </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>5m39s
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>pod/istiod-7d6dff85dd-w5szx<span class="w">                 </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>29m
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>pod/kiali-696bb665-sngrt<span class="w">                    </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>5m43s
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>pod/prometheus-564768879c-w55nb<span class="w">             </span><span class="m">2</span>/2<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>5m39s
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>NAME<span class="w">                                </span>TYPE<span class="w">           </span>CLUSTER-IP<span class="w">       </span>EXTERNAL-IP<span class="w">                                                              </span>PORT<span class="o">(</span>S<span class="o">)</span><span class="w">                                                                                                                                      </span>AGE
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>service/grafana<span class="w">                     </span>ClusterIP<span class="w">      </span><span class="m">172</span>.20.151.105<span class="w">   </span>&lt;none&gt;<span class="w">                                                                   </span><span class="m">3000</span>/TCP<span class="w">                                                                                                                                     </span>5m50s
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>service/istio-egressgateway<span class="w">         </span>ClusterIP<span class="w">      </span><span class="m">172</span>.20.208.92<span class="w">    </span>&lt;none&gt;<span class="w">                                                                   </span><span class="m">80</span>/TCP,443/TCP,15443/TCP<span class="w">                                                                                                                     </span>29m
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>service/istio-ingressgateway<span class="w">        </span>LoadBalancer<span class="w">   </span><span class="m">172</span>.20.170.225<span class="w">   </span>aa7cfd0021476452ba8c3836365f2df3-478100139.us-east-1.elb.amazonaws.com<span class="w">   </span><span class="m">15020</span>:31474/TCP,80:30046/TCP,443:31013/TCP,15029:31841/TCP,15030:31961/TCP,15031:30599/TCP,15032:30637/TCP,31400:31608/TCP,15443:32324/TCP<span class="w">   </span>29m
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>service/istio-pilot<span class="w">                 </span>ClusterIP<span class="w">      </span><span class="m">172</span>.20.97.20<span class="w">     </span>&lt;none&gt;<span class="w">                                                                   </span><span class="m">15010</span>/TCP,15011/TCP,15012/TCP,8080/TCP,15014/TCP,443/TCP<span class="w">                                                                                     </span>29m
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>service/istiod<span class="w">                      </span>ClusterIP<span class="w">      </span><span class="m">172</span>.20.236.155<span class="w">   </span>&lt;none&gt;<span class="w">                                                                   </span><span class="m">15012</span>/TCP,443/TCP<span class="w">                                                                                                                            </span>29m
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>service/jaeger-agent<span class="w">                </span>ClusterIP<span class="w">      </span>None<span class="w">             </span>&lt;none&gt;<span class="w">                                                                   </span><span class="m">5775</span>/UDP,6831/UDP,6832/UDP<span class="w">                                                                                                                   </span>5m35s
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>service/jaeger-collector<span class="w">            </span>ClusterIP<span class="w">      </span><span class="m">172</span>.20.177.164<span class="w">   </span>&lt;none&gt;<span class="w">                                                                   </span><span class="m">14267</span>/TCP,14268/TCP,14250/TCP<span class="w">                                                                                                                </span>5m37s
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>service/jaeger-collector-headless<span class="w">   </span>ClusterIP<span class="w">      </span>None<span class="w">             </span>&lt;none&gt;<span class="w">                                                                   </span><span class="m">14250</span>/TCP<span class="w">                                                                                                                                    </span>5m36s
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>service/jaeger-query<span class="w">                </span>ClusterIP<span class="w">      </span><span class="m">172</span>.20.116.249<span class="w">   </span>&lt;none&gt;<span class="w">                                                                   </span><span class="m">16686</span>/TCP<span class="w">                                                                                                                                    </span>5m38s
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>service/kiali<span class="w">                       </span>ClusterIP<span class="w">      </span><span class="m">172</span>.20.253.248<span class="w">   </span>&lt;none&gt;<span class="w">                                                                   </span><span class="m">20001</span>/TCP<span class="w">                                                                                                                                    </span>5m45s
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>service/prometheus<span class="w">                  </span>ClusterIP<span class="w">      </span><span class="m">172</span>.20.101.184<span class="w">   </span>&lt;none&gt;<span class="w">                                                                   </span><span class="m">9090</span>/TCP<span class="w">                                                                                                                                     </span>5m41s
<a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a>service/tracing<span class="w">                     </span>ClusterIP<span class="w">      </span><span class="m">172</span>.20.143.171<span class="w">   </span>&lt;none&gt;<span class="w">                                                                   </span><span class="m">80</span>/TCP<span class="w">                                                                                                                                       </span>5m33s
<a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>service/zipkin<span class="w">                      </span>ClusterIP<span class="w">      </span><span class="m">172</span>.20.170.147<span class="w">   </span>&lt;none&gt;<span class="w">                                                                   </span><span class="m">9411</span>/TCP<span class="w">                                          </span>
</code></pre></div></p>
<p>In cas you're using AWS as a cloud provider, you should notice that the service <code>istio-ingressgateway</code> in <code>istio-system</code> namespace created AWS ELB of type classic load balancer
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>service/istio-ingressgateway        LoadBalancer   10.100.229.231   a5a1acc36239d46038f3dd828465c946-706040707.us-west-2.elb.amazonaws.com   15020:32676/TCP,80:32703/TCP,443:30964/TCP,31400:30057/TCP,15443:32059/TCP   15m
</code></pre></div></p>
<p>Using AWS console, check AWS ELB created by istio ingress gateway service:</p>
<p><img alt="alt text" src="../imgs/ingress_gateway_aws_elb.png" title="Istio" /></p>
<p>Also notice a pod <code>istiod-7d6dff85dd-w5szx</code>.
This is the pod that contains istio pilot (service discovery), Galley (config), sidecar injector, that is <code>istiod</code>.</p>
<blockquote>
<p>istiod unifies functionality that Pilot, Galley, Citadel and the sidecar injector previously performed, into a single binary</p>
</blockquote>
<h3 id="enable-istio-sidecar-injection">Enable Istio Sidecar Injection</h3>
<p>Add a namespace label to instruct Istio to automatically inject Envoy sidecar proxies when you deploy your application later
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># first describe default namespace</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>kubectl<span class="w"> </span>describe<span class="w"> </span>ns<span class="w"> </span>default
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c1"># output</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>Name:<span class="w">         </span>default
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>Labels:<span class="w">       </span>&lt;none&gt;
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>Annotations:<span class="w">  </span>&lt;none&gt;
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>Status:<span class="w">       </span>Active
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>No<span class="w"> </span>resource<span class="w"> </span>quota.
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>No<span class="w"> </span>resource<span class="w"> </span>limits.
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="c1"># enable istio sidecar injection by adding a label</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>kubectl<span class="w"> </span>label<span class="w"> </span>namespace<span class="w"> </span>default<span class="w"> </span>istio-injection<span class="o">=</span>enabled
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="c1"># verify label is added</span>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="c1"># output</span>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>Name:<span class="w">         </span>default
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>Labels:<span class="w">       </span>istio-injection<span class="o">=</span>enabled
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a>Annotations:<span class="w">  </span>&lt;none&gt;
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a>Status:<span class="w">       </span>Active
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>No<span class="w"> </span>resource<span class="w"> </span>quota.
<a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a>No<span class="w"> </span>resource<span class="w"> </span>limits.
<a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a>
<a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a><span class="c1"># to disable</span>
<a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a>kubectl<span class="w"> </span>label<span class="w"> </span>namespace<span class="w"> </span>default<span class="w"> </span>istio-injection-
</code></pre></div></p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 <a href="https://github.com/Yassine-Teimi"  target="_blank" rel="noopener">Yassine TEIMI</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.ibm.com/Yassine-Teimi" target="_blank" rel="noopener" title="github.ibm.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/yassine-teimi" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js"></script>
      
    
  </body>
</html>